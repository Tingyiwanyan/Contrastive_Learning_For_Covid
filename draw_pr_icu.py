import numpy as np
import matplotlib.pyplot as plt





precision_retain_ce = [0.17224199, 0.18890643, 0.41168711, 0.49811202, 0.54342034,
       0.56462927, 0.59794944, 0.61305052, 0.63255196, 0.63702024,
       0.65054444, 0.64554705, 0.64342174, 0.64911363, 0.6472129 ,
       0.65029655, 0.66462172, 0.67217009, 0.67407295, 0.68026732,
       0.69556219, 0.71002429, 0.72195224, 0.72817734, 0.72953121,
       0.7460728 , 0.76531302, 0.76701629, 0.7650663 , 0.7757686 ,
       0.75921648, 0.77220588, 0.76      , 0.78264791, 0.81616162,
       0.85285714, 0.8       , 1.        , 1.        , 1.        ,
       1.        ]

recall_retain_ce = [1.        , 0.97768946, 0.74130947, 0.63740026, 0.59427587,
       0.53869509, 0.50542525, 0.47161177, 0.45307191, 0.43838326,
       0.4281954 , 0.39854722, 0.38231652, 0.36828215, 0.34732036,
       0.33508086, 0.32873951, 0.31983806, 0.3116304 , 0.30320513,
       0.2935689 , 0.28147775, 0.27495725, 0.26455178, 0.25997303,
       0.25128918, 0.24264231, 0.23212296, 0.21449921, 0.20878492,
       0.18830331, 0.16558616, 0.13055155, 0.10036298, 0.07328144,
       0.04107422, 0.01190476, 0.00238095, 0.        , 0.        ,
       0.        ]

precision_ce_rnn_icu=[0.17224199, 0.17224199, 0.17224199, 0.17224199, 0.20335618,
       0.24041357, 0.29259264, 0.32493386, 0.37476566, 0.40949825,
       0.42879224, 0.45062645, 0.46620953, 0.48135933, 0.4852267 ,
       0.49090439, 0.50224511, 0.50841268, 0.5139152 , 0.51820397,
       0.52346754, 0.52990468, 0.53586039, 0.54687021, 0.55206019,
       0.55725078, 0.55999291, 0.56263645, 0.56507508, 0.57109931,
       0.56579554, 0.5692934 , 0.57757963, 0.58475818, 0.59417235,
       0.59765789, 0.60264327, 0.60961384, 0.61154527, 0.6135639 ,
       0.6172488 , 0.62246286, 0.62178772, 0.62297252, 0.62722243,
       0.627879  , 0.63149804, 0.6298275 , 0.63325084, 0.63711205,
       0.63817931, 0.64091397, 0.63919625, 0.64393264, 0.64961897,
       0.64783389, 0.64572219, 0.65262646, 0.65302573, 0.65116555,
       0.66035059, 0.6641498 , 0.67419289, 0.68420665, 0.68828577,
       0.68599964, 0.68661385, 0.68817828, 0.68856782, 0.68783883,
       0.69100516, 0.68935615, 0.69125867, 0.69192171, 0.69580191,
       0.69580191, 0.70520745, 0.71241221, 0.71708791, 0.71948718,
       0.71902459, 0.7174065 , 0.71773387, 0.72300624, 0.7218448 ,
       0.72504011, 0.72971488, 0.73207793, 0.73543395, 0.73305047,
       0.73161082, 0.73161082, 0.73879896, 0.74700805, 0.74861977,
       0.75316523, 0.75559875, 0.7517111 , 0.7478355 , 0.75230392,
       0.75835128, 0.76667435, 0.77214975, 0.76556608, 0.76615854,
       0.76721578, 0.76808789, 0.76553361, 0.76783476, 0.76833333,
       0.77355072, 0.76827373, 0.77754941, 0.77438735, 0.78969836,
       0.79933051, 0.79617225, 0.82080675, 0.82620155, 0.83374119,
       0.82777778, 0.820739  , 0.827434  , 0.82323232, 0.82092784,
       0.8292454 , 0.84664799, 0.84453159, 0.84296296, 0.84766885,
       0.89532051, 0.9174359 , 0.92575251, 0.93916084, 0.93198381,
       0.92626263, 0.92444444, 0.95294118, 0.94666667, 0.95      ,
       0.96363636, 0.96363636, 0.97777778, 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        ]

recall_ce_rnn_icu=[1.        , 1.        , 1.        , 1.        , 0.96611722,
       0.91874956, 0.87177972, 0.82055863, 0.78930779, 0.76717818,
       0.7392926 , 0.72730916, 0.70217553, 0.68616497, 0.6668925 ,
       0.64366218, 0.62673222, 0.6190392 , 0.60859675, 0.59376087,
       0.57862832, 0.57478181, 0.5682613 , 0.56196094, 0.55573348,
       0.55163091, 0.54140607, 0.53510317, 0.5271541 , 0.5271541 ,
       0.51667573, 0.51279077, 0.51084902, 0.51084902, 0.51084902,
       0.50667102, 0.50429007, 0.50230987, 0.50040511, 0.49846336,
       0.49406776, 0.49168681, 0.48347915, 0.47937658, 0.47739638,
       0.47541619, 0.47153269, 0.46764773, 0.46346973, 0.46346973,
       0.46152798, 0.45958624, 0.45570128, 0.45372108, 0.44943536,
       0.44170536, 0.43782186, 0.43107976, 0.4271948 , 0.42330984,
       0.42136809, 0.42136809, 0.41917029, 0.41917029, 0.41334358,
       0.40916558, 0.40074032, 0.39876012, 0.39656232, 0.39025942,
       0.38589827, 0.37912171, 0.37714152, 0.37329501, 0.37139024,
       0.37139024, 0.37139024, 0.36750528, 0.36362032, 0.36167858,
       0.35555883, 0.34731418, 0.34291858, 0.34097683, 0.33859588,
       0.33669112, 0.33431016, 0.3304252 , 0.32852044, 0.32415929,
       0.32221755, 0.32221755, 0.32031278, 0.31811498, 0.31621022,
       0.31621022, 0.3119245 , 0.30522085, 0.29752637, 0.29532857,
       0.29338682, 0.2895773 , 0.2895773 , 0.27422678, 0.26990408,
       0.26367662, 0.25788836, 0.2537858 , 0.24770303, 0.23931475,
       0.23740999, 0.23088949, 0.22692909, 0.22282653, 0.22062873,
       0.21674377, 0.20619214, 0.20381119, 0.19725224, 0.18757902,
       0.18175231, 0.17386997, 0.16764251, 0.16133961, 0.1487708 ,
       0.14298108, 0.13623898, 0.12949687, 0.12510127, 0.12081555,
       0.11887381, 0.11693206, 0.11055626, 0.1023486 , 0.09446626,
       0.08376775, 0.07380296, 0.06556085, 0.05727775, 0.04705291,
       0.04705291, 0.04705291, 0.03474268, 0.02228412, 0.01818155,
       0.00806296, 0.00806296, 0.00190476, 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        ]

precision_RNN_cl = [0.17224199, 0.17224199, 0.17224199, 0.17224199, 0.2126725 ,
       0.25476925, 0.28463821, 0.30804498, 0.3233129 , 0.34263735,
       0.37652479, 0.38950207, 0.40376913, 0.41547117, 0.42177744,
       0.43499937, 0.44329152, 0.45050616, 0.45698207, 0.46457205,
       0.4748841 , 0.48781581, 0.48981871, 0.49736645, 0.5042855 ,
       0.50635987, 0.51070183, 0.51618162, 0.52220692, 0.52497882,
       0.53186613, 0.53662964, 0.54054349, 0.54451682, 0.54559329,
       0.54697869, 0.54848642, 0.54693894, 0.55252795, 0.55946748,
       0.56243012, 0.56574266, 0.57205759, 0.57251351, 0.57386068,
       0.57739734, 0.58291966, 0.58408226, 0.58598392, 0.58664222,
       0.58899875, 0.59337803, 0.59733109, 0.59841842, 0.60080947,
       0.60489497, 0.6092422 , 0.60740008, 0.60983336, 0.60834834,
       0.6125265 , 0.61800762, 0.62103135, 0.62409312, 0.62846186,
       0.63532634, 0.63987486, 0.63987486, 0.64239321, 0.64168185,
       0.64100415, 0.64233108, 0.64172148, 0.64445003, 0.64438114,
       0.64765813, 0.65255952, 0.65371   , 0.65163248, 0.65070693,
       0.65162529, 0.65656537, 0.65811443, 0.66027691, 0.6613855 ,
       0.66051227, 0.66782293, 0.6692185 , 0.67506903, 0.67562671,
       0.67473385, 0.67836745, 0.68117464, 0.68388678, 0.68842055,
       0.69229016, 0.70084894, 0.69955024, 0.70218182, 0.7057051 ,
       0.7057051 , 0.70417454, 0.70385257, 0.7044091 , 0.70411547,
       0.69944115, 0.70952761, 0.71137871, 0.71357969, 0.71428518,
       0.71318315, 0.70765714, 0.71144725, 0.71273304, 0.72216172,
       0.72944649, 0.73613146, 0.74787637, 0.76121457, 0.76200405,
       0.76253411, 0.7634689 , 0.76629073, 0.76455504, 0.77174644,
       0.77879774, 0.78777796, 0.79074634, 0.79399309, 0.80520078,
       0.81025556, 0.81677419, 0.81042162, 0.8025148 , 0.80473448,
       0.81174485, 0.81000244, 0.82495528, 0.81612676, 0.84440191,
       0.84855521, 0.86256596, 0.86914422, 0.87255375, 0.89090226,
       0.92321429, 0.95      , 0.98181818, 0.97777778, 0.97777778,
       0.97777778, 0.97777778, 0.975     , 0.975     , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        ]

recall_cl_rnn = [1.        , 1.        , 1.        , 1.        , 0.96552354,
       0.91800355, 0.88118276, 0.85748024, 0.84051583, 0.82545871,
       0.81362467, 0.79310461, 0.78292075, 0.77911123, 0.76269844,
       0.74972888, 0.74390363, 0.73562453, 0.72499893, 0.71851542,
       0.706862  , 0.70301549, 0.68960672, 0.68334081, 0.68136061,
       0.67509617, 0.66736616, 0.66538596, 0.65882701, 0.65270726,
       0.64644135, 0.63929849, 0.63127398, 0.62698827, 0.62090697,
       0.61870917, 0.61680441, 0.61057695, 0.61057695, 0.60599819,
       0.59749749, 0.59511654, 0.58877519, 0.58419644, 0.58229167,
       0.58229167, 0.57840671, 0.57646497, 0.57254302, 0.56818187,
       0.56818187, 0.56598407, 0.56404232, 0.56404232, 0.56404232,
       0.56166137, 0.56166137, 0.55752182, 0.55359987, 0.54748013,
       0.54748013, 0.54557536, 0.54337756, 0.53901641, 0.53509447,
       0.53289666, 0.53289666, 0.53289666, 0.53091647, 0.5290117 ,
       0.52095021, 0.52095021, 0.51266711, 0.51068691, 0.50658435,
       0.5024448 , 0.49815909, 0.49625432, 0.49211477, 0.49017303,
       0.48599503, 0.47995072, 0.47995072, 0.47995072, 0.47797052,
       0.47599032, 0.47122841, 0.46932365, 0.4647449 , 0.46093537,
       0.45899363, 0.45280315, 0.44891966, 0.4445585 , 0.44063656,
       0.43865636, 0.4367516 , 0.43437065, 0.43437065, 0.43217284,
       0.43217284, 0.42832634, 0.42206042, 0.41403591, 0.40802859,
       0.39952789, 0.39758614, 0.39758614, 0.39370118, 0.39132023,
       0.38527592, 0.37509059, 0.37270964, 0.37051183, 0.37051183,
       0.36248732, 0.35471887, 0.34658665, 0.34658665, 0.34270315,
       0.33654495, 0.33273543, 0.33075523, 0.32016662, 0.31349995,
       0.31151975, 0.30543699, 0.29701173, 0.29463078, 0.29030808,
       0.27403746, 0.26539059, 0.25494668, 0.24234088, 0.22617544,
       0.22013113, 0.20605832, 0.20166271, 0.18935395, 0.17538885,
       0.16556476, 0.15310366, 0.14654471, 0.13804401, 0.11734298,
       0.09686354, 0.08228008, 0.07235081, 0.05542484, 0.04872119,
       0.04439849, 0.02908643, 0.02490842, 0.0210989 , 0.0167033 ,
       0.01479853, 0.01289377, 0.01098901, 0.00659341, 0.00659341,
       0.0021978 , 0.0021978 , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        ]


precision_cl_retain_icu = [0.17224199, 0.20753078, 0.37626277, 0.45401269, 0.50388093,
       0.53945258, 0.55350211, 0.57060207, 0.58768186, 0.59696839,
       0.61776521, 0.6235327 , 0.63360907, 0.63744871, 0.64716477,
       0.65777298, 0.66535006, 0.6769723 , 0.68918341, 0.691313  ,
       0.69436944, 0.69986374, 0.7035098 , 0.70830455, 0.70572919,
       0.70740916, 0.71832512, 0.72940375, 0.73824668, 0.72904765,
       0.74636513, 0.75606154, 0.77377739, 0.7812381 , 0.76507937,
       0.72027473, 0.78333333, 1.        , 1.        , 1.        ,
       1.        ]

recall_cl_retain_icu = [1.        , 0.96446131, 0.79446903, 0.71452532, 0.65351712,
       0.62820288, 0.59643886, 0.57563047, 0.55870304, 0.5401269 ,
       0.52301632, 0.51264931, 0.49820802, 0.4830062 , 0.47303994,
       0.45680777, 0.44673234, 0.43204116, 0.41591417, 0.39708491,
       0.3849553 , 0.3750275 , 0.36681984, 0.36073854, 0.34234702,
       0.32615583, 0.31919613, 0.2992284 , 0.29068925, 0.26566405,
       0.24803159, 0.22604669, 0.20076472, 0.16891004, 0.13237142,
       0.07257241, 0.01879228, 0.        , 0.        , 0.        ,
       0.        ]




plt.xlabel("Recall")
plt.ylabel("Precision")
plt.title("ICU Prediction", fontsize=14)
plt.xlim(0.0, 1.0)
plt.ylim(0.0, 1.0)
x = [0.0, 1.0]
#plt.plot(x, x, linestyle='dashed', color='red', linewidth=2, label='random')

plt.plot(recall_ce_rnn_icu, precision_ce_rnn_icu, color='g', linestyle='dashed', linewidth=1, label='RNN+CE(AUC=0.832)')


plt.plot(recall_retain_ce,precision_retain_ce,color='blue',linestyle='dashed', label='RETAIN+CE(AUC=0.802)')

#plt.plot(fp_rate_hl_retain,tp_rate_hl_retain,color='orange',label='RETAIN+HL')

plt.plot(recall_cl_rnn,precision_RNN_cl,color='violet',linewidth=1.5,label='RNN+CL(AUC=0.843)')
plt.plot(recall_cl_retain_icu, precision_cl_retain_icu, color='red', linewidth=1.5, label='RETAIN+CL(AUC=0.821)')


plt.legend(loc='lower right')
plt.show()